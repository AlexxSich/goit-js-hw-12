{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImages } from \"./js/pixabay-api\";\nimport { imageTemplate } from \"./js/render-functions\";\n\nconst userInput = document.querySelector(\".search-images-form\");\nconst myGallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader-container\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\")\n\nuserInput.addEventListener('submit', userInputHandler);\nloadMoreBtn.addEventListener('click', onLoadMoreClick)\n\nconst lightBox = new SimpleLightbox('.gallery-link', {\n    captionsData: 'alt',\n    captionDelay: 250,\n})\n\nlet searchedImg;\nlet currentPage = 1;\nconst perPage = 15;\n\nasync function userInputHandler(event) {\n    event.preventDefault();\n    loader.classList.add(\"active\");\n    myGallery.innerHTML = \"\";\n    currentPage = 1;\n    searchedImg = event.target.elements.search.value.trim();\n    \n    if(searchedImg !== \"\") {     \n       \n            try{\n                const images = await getImages(searchedImg, currentPage)\n                if(images.hits.length === 0) {\n                iziToast.error({\n                    position: 'topRight',\n                    title: 'Error',\n                    message: '❌ Sorry, there are no images matching your search query. Please try again!',\n                });\n            return;\n        };   \n\n        myGallery.insertAdjacentHTML(\"beforeend\", imagesArr(images));\n\n        if(images.hits.length >= 15) {\n            loadMoreBtn.classList.remove(\"is-hidden\")\n        }       \n\n        lightBox.refresh();\n        userInput.reset();                                \n}\n            catch(error) {\n                iziToast.error({\n                position: 'topRight',\n                title: 'Error',\n                message: '❌ Something went wrong. Try again later.',\n            });\n        }\n            finally{\n                loader.classList.remove(\"active\");\n                };            \n    } else {\n            iziToast.error({\n                position: 'topRight',\n                title: 'Error',\n                message: '❌ Please input your request in the search field',\n                });\n        };        \n    };   \n\n    function imagesArr(obj) {     \n        return obj.hits.map(imageTemplate).join(\"\");\n    };\n\nasync function onLoadMoreClick(event){\n        loader.classList.add(\"active\");\n    \n    if(searchedImg !== \"\") {\n        currentPage += 1;      \n            \n        try{\n            const images = await getImages(searchedImg, currentPage)\n            const totalPages = Math.ceil(images.totalHits / perPage);\n            myGallery.insertAdjacentHTML(\"beforeend\", imagesArr(images))\n\n            myScroll();\n           \n            if(currentPage === totalPages){\n                loadMoreBtn.classList.add(\"is-hidden\")\n                iziToast.info({\n                    position: 'topRight',\n                    title: 'info',\n                    color:\"blue\",\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                });\n            }\n            \n            lightBox.refresh();\n            userInput.reset();                                \n}\n        catch(error) {\n                iziToast.error({\n                position: 'topRight',\n                title: 'Error',\n                message: '❌ Something went wrong. Try again later.',\n            });\n        }\n            finally{\n                loader.classList.remove(\"active\");\n                };\n    } else {\n            iziToast.error({\n                position: 'topRight',\n                title: 'Error',\n                message: '❌ Please input your request in the search field',\n                });\n        };        \n    }\n\nfunction myScroll() {\n    //   ?? Підкажіть будь ласка чому catch() на 106 рядку ловить це як помилку - const height = myGallery.firstElementChild.getBpoundingClientRect().height ?\n\n     scrollBy({\n        top: 570,\n        behavior: \"smooth\",\n    });\n}"],"names":["userInput","myGallery","loader","loadMoreBtn","userInputHandler","onLoadMoreClick","lightBox","SimpleLightbox","searchedImg","currentPage","perPage","event","images","getImages","iziToast","imagesArr","obj","imageTemplate","totalPages","myScroll"],"mappings":"0MASA,MAAMA,EAAY,SAAS,cAAc,qBAAqB,EACxDC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAS,SAAS,cAAc,mBAAmB,EACnDC,EAAc,SAAS,cAAc,gBAAgB,EAE3DH,EAAU,iBAAiB,SAAUI,CAAgB,EACrDD,EAAY,iBAAiB,QAASE,CAAe,EAErD,MAAMC,EAAW,IAAIC,EAAe,gBAAiB,CACjD,aAAc,MACd,aAAc,GAClB,CAAC,EAED,IAAIC,EACAC,EAAc,EAClB,MAAMC,EAAU,GAEhB,eAAeN,EAAiBO,EAAO,CAOnC,GANAA,EAAM,eAAc,EACpBT,EAAO,UAAU,IAAI,QAAQ,EAC7BD,EAAU,UAAY,GACtBQ,EAAc,EACdD,EAAcG,EAAM,OAAO,SAAS,OAAO,MAAM,OAE9CH,IAAgB,GAEX,GAAG,CACC,MAAMI,EAAS,MAAMC,EAAUL,EAAaC,CAAW,EACvD,GAAGG,EAAO,KAAK,SAAW,EAAG,CAC7BE,EAAS,MAAM,CACX,SAAU,WACV,MAAO,QACP,QAAS,4EAC7B,CAAiB,EACL,MACZ,CAEQb,EAAU,mBAAmB,YAAac,EAAUH,CAAM,CAAC,EAExDA,EAAO,KAAK,QAAU,IACrBT,EAAY,UAAU,OAAO,WAAW,EAG5CG,EAAS,QAAO,EAChBN,EAAU,MAAK,CACvB,MACyB,CACTc,EAAS,MAAM,CACf,SAAU,WACV,MAAO,QACP,QAAS,0CACzB,CAAa,CACJ,QACU,CACHZ,EAAO,UAAU,OAAO,QAAQ,CAChD,MAEYY,EAAS,MAAM,CACX,SAAU,WACV,MAAO,QACP,QAAS,iDACzB,CAAiB,CAGjB,CACI,SAASC,EAAUC,EAAK,CACpB,OAAOA,EAAI,KAAK,IAAIC,CAAa,EAAE,KAAK,EAAE,CAElD,CACA,eAAeZ,EAAgBM,EAAM,CAGjC,GAFIT,EAAO,UAAU,IAAI,QAAQ,EAE9BM,IAAgB,GAAI,CACnBC,GAAe,EAEf,GAAG,CACC,MAAMG,EAAS,MAAMC,EAAUL,EAAaC,CAAW,EACjDS,EAAa,KAAK,KAAKN,EAAO,UAAYF,CAAO,EACvDT,EAAU,mBAAmB,YAAac,EAAUH,CAAM,CAAC,EAE3DO,IAEGV,IAAgBS,IACff,EAAY,UAAU,IAAI,WAAW,EACrCW,EAAS,KAAK,CACV,SAAU,WACV,MAAO,OACP,MAAM,OACN,QAAS,4DAC7B,CAAiB,GAGLR,EAAS,QAAO,EAChBN,EAAU,MAAK,CAC3B,MACqB,CACLc,EAAS,MAAM,CACf,SAAU,WACV,MAAO,QACP,QAAS,0CACzB,CAAa,CACJ,QACU,CACHZ,EAAO,UAAU,OAAO,QAAQ,CAChD,OAEYY,EAAS,MAAM,CACX,SAAU,WACV,MAAO,QACP,QAAS,iDACzB,CAAiB,CAEZ,CAEL,SAASK,GAAW,CAGf,SAAS,CACN,IAAK,IACL,SAAU,QAClB,CAAK,CACL"}